import spacy

nlp = spacy.load("en_core_web_md")

text = """Karishma left for college.
It started raining heavily.
She took her umbrella."""

doc = nlp(text)
sentences = [sent.text.strip() for sent in doc.sents]

# Manual pairwise logic (in case Python < 3.10)
similarities = []
for i in range(len(sentences) - 1):
    s1, s2 = sentences[i], sentences[i + 1]
    sim = nlp(s1).similarity(nlp(s2))
    similarities.append(sim)

coherence_score = sum(similarities) / len(similarities)
print("Sentences:", sentences)
print("Pairwise Similarities:", similarities)
print(f"Coherence Score: {coherence_score:.2f}")

if coherence_score > 0.75:
    print("The text is highly coherent.")
elif coherence_score > 0.5:
    print("The text is moderately coherent.")
else:
    print("The text is poorly coherent.")
